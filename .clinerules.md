# Cline Rules — Mythic Story Repository (MSR)

## Architectural boundaries
- Business logic is framework-agnostic and lives in `/src/core`.
  - **No React/Next/Prisma imports** in `/src/core/domain` or `/src/core/usecases`.
- Routes are thin. They call usecases in `/src/core` through server handlers in `/src/features/*/server`.
- Zod schemas live in `/src/features/<feature>/schema.ts`.
- Single source of truth for DB schema: `/src/core/db/prisma.schema`.

## Folder expectations
- `/src/app` → Next.js App Router routes (public/auth/app groups).
- `/src/features` → Feature slices (components, server, schema, db).
- `/src/components` → Shared UI primitives only.
- `/src/lib` → Cross-cutting helpers (logger, result.ts, date utils).
- `/ADR` → One-page notes for any new dependency or structural change.

## Coding & quality
- TypeScript strict mode; keep `/src/core` pure + testable.
- Tests live in `/src/tests`. Update them on non-trivial refactors.
- Always respect consent, anonymity, licensing fields in story flows.

## If a rule blocks progress
- Do NOT bypass boundaries silently.  
- Instead: propose an ADR with trade-offs, then proceed.
